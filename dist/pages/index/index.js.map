{"version":3,"file":"pages/index/index.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACtIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://eco-viz-mini/./src/pages/index/index.tsx?63ff","webpack://eco-viz-mini/._src_pages_index_index.tsx"],"sourcesContent":["import _regenerator from \"/Users/insentek/WorkSpace/insentek-web/eco-viz-mini-program/eco-viz-mini/node_modules/@babel/runtime/helpers/esm/regenerator.js\";\nimport _asyncToGenerator from \"/Users/insentek/WorkSpace/insentek-web/eco-viz-mini-program/eco-viz-mini/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/Users/insentek/WorkSpace/insentek-web/eco-viz-mini-program/eco-viz-mini/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useEffect, useState } from 'react';\nimport { View, Text } from '@tarojs/components';\nimport Taro from '@tarojs/taro';\nimport { checkLoginStatus, wechatSilentLogin } from '../../utils/auth';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default function IndexPage() {\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    hasChecked = _useState2[0],\n    setHasChecked = _useState2[1];\n\n  // é¦–æ¬¡åŠ è½½æ£€æŸ¥\n  useEffect(function () {\n    checkLoginAndRedirect();\n  }, []);\n  var checkLoginAndRedirect = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee() {\n      var loginResult, silentLoginResult, _silentLoginResult, _t, _t2;\n      return _regenerator().w(function (_context) {\n        while (1) switch (_context.p = _context.n) {\n          case 0:\n            setHasChecked(true);\n            _context.p = 1;\n            _context.n = 2;\n            return checkLoginStatus();\n          case 2:\n            loginResult = _context.v;\n            if (!loginResult.isLoggedIn) {\n              _context.n = 3;\n              break;\n            }\n            // å·²ç™»å½•ï¼Œè·³è½¬åˆ°é¦–é¡µ\n            Taro.switchTab({\n              url: '/pages/home/index',\n              fail: function fail() {\n                Taro.reLaunch({\n                  url: '/pages/home/index'\n                });\n              }\n            });\n            _context.n = 5;\n            break;\n          case 3:\n            // æœªç™»å½•ï¼Œå°è¯•å¾®ä¿¡é™é»˜ç™»å½•\n            console.log('ğŸ”„ å°è¯•å¾®ä¿¡é™é»˜ç™»å½•...');\n            _context.n = 4;\n            return wechatSilentLogin();\n          case 4:\n            silentLoginResult = _context.v;\n            if (silentLoginResult.success) {\n              // é™é»˜ç™»å½•æˆåŠŸï¼Œè·³è½¬åˆ°é¦–é¡µ\n              console.log('âœ… å¾®ä¿¡é™é»˜ç™»å½•æˆåŠŸ');\n              Taro.switchTab({\n                url: '/pages/home/index',\n                fail: function fail() {\n                  Taro.reLaunch({\n                    url: '/pages/home/index'\n                  });\n                }\n              });\n            } else {\n              // é™é»˜ç™»å½•å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º\n              console.error('âŒ å¾®ä¿¡é™é»˜ç™»å½•å¤±è´¥:', silentLoginResult.error);\n              Taro.showToast({\n                title: silentLoginResult.error || 'ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•',\n                icon: 'none',\n                duration: 3000\n              });\n            }\n          case 5:\n            _context.n = 10;\n            break;\n          case 6:\n            _context.p = 6;\n            _t = _context.v;\n            console.error('æ£€æŸ¥ç™»å½•çŠ¶æ€å¤±è´¥:', _t);\n            // å‘ç”Ÿé”™è¯¯æ—¶ï¼Œå°è¯•é™é»˜ç™»å½•\n            _context.p = 7;\n            _context.n = 8;\n            return wechatSilentLogin();\n          case 8:\n            _silentLoginResult = _context.v;\n            if (_silentLoginResult.success) {\n              Taro.switchTab({\n                url: '/pages/home/index',\n                fail: function fail() {\n                  Taro.reLaunch({\n                    url: '/pages/home/index'\n                  });\n                }\n              });\n            } else {\n              Taro.showToast({\n                title: _silentLoginResult.error || 'ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•',\n                icon: 'none',\n                duration: 3000\n              });\n            }\n            _context.n = 10;\n            break;\n          case 9:\n            _context.p = 9;\n            _t2 = _context.v;\n            console.error('ç™»å½•å¤±è´¥:', _t2);\n            Taro.showToast({\n              title: 'ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•',\n              icon: 'none',\n              duration: 3000\n            });\n          case 10:\n            return _context.a(2);\n        }\n      }, _callee, null, [[7, 9], [1, 6]]);\n    }));\n    return function checkLoginAndRedirect() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  return /*#__PURE__*/_jsx(View, {\n    style: {\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      height: '100vh',\n      flexDirection: 'column',\n      gap: '20px'\n    },\n    children: /*#__PURE__*/_jsx(Text, {\n      children: \"\\u6B63\\u5728\\u521D\\u59CB\\u5316...\"\n    })\n  });\n}","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pages/index/index!./index.tsx\"\nvar config = {\"navigationBarTitleText\":\"å†œä¸šç‰©è”\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/index/index', {root:{cn:[]}}, config || {}))\n\n\nexport default component\n"],"names":[],"sourceRoot":""}